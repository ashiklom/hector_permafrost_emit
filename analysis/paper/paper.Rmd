---
title: "Hector Permafrost"
author:
  - Alexey N. Shiklomanov
  - Ben Bond-Lamberty
  - Ben Kravitz
  - Corinne Hartin
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: 
    bookdown::html_document2:
      fig_caption: yes
      reference_docx: "../templates/template.docx"
    rmarkdown::github_document:
      html_preview: false
bibliography: ["references.bib", "packages.bib"]
csl: "../templates/biogeosciences.csl"
abstract: |
  Text of abstract
keywords: |
  keyword 1; keyword 2; keyword 3
highlights: |
  These are the highlights. 
---

```{r setup, echo = FALSE}
library(drake)
library(knitr)
library(here)

opts_chunk$set(
  collapse = TRUE,
  warning = FALSE,
  message = FALSE,
  echo = FALSE,
  comment = "#>"
)

library(hector.permafrost.emit)

# Dummy target to force-rebuild this when figures change
invisible(readd(figs_dir_t))

fig <- function(...) {
  filepath <- here("analysis", "figures", ...)
  knitr::include_graphics(file_in(filepath))
}

n <- 0
mdcap <- function(text) {
  n <<- n + 1
  out <- sprintf("**Figure %d**: %s", n, text)
  if (grepl("gfm", knitr::opts_knit$get("rmarkdown.pandoc.to"), ignore.case = TRUE)) {
    out
  } else {
    invisible(NULL)
  }
}

m <- 0
htmlfig <- function() {
  m <<- m + 1
  out <- paste0("**Figure ", m, "**:")
  if (grepl("html", knitr::opts_knit$get("rmarkdown.pandoc.to"), ignore.case = TRUE)) {
    out
  } else {
    invisible(NULL)
  }
}
```

# Introduction

Climate change is a problem [@ipcc_ar5_wg1].
Important to reduce carbon emissions to meet temperature targets.
The extent of anthropogenic emissions reduction depends on what how much help (or push-back) we get from the physical and biological Earth systems.

Permafrost is an important C reservoir.
The total northern soil C pool is estimated at 1672 PgC, of which approximately 1466 Pg (88%) is in permafrost [@tarnocai_2009_soil].
More recent estimates suggest that total high-latitude soil organic matter pool is 1300 Pg, with roughly 800 Pg in permafrost [@hugelius_2014_estimated].
This frozen C can be released into the atmosphere by several processes related to warming, including aerobic respiration in thawed soil (REF) and anaeribic respiration in thermokarst lakes and wetlands [@turetsky_2002_boreal; @wickland_2006_effects].
But emissions from wet soils may be offset by high organic matter accumulation rates [@camill_2001_changes].
Permafrost thaw in boreal peatlands in north-central Saskatchewan increased CO2 and CH4 fluxes from soil to atmosphere by 1.6 and 30 times, respectively [@turetsky_2002_boreal].
These impacts are exacerbated by the fact that the Arctic is warming roughly 2.5 (TODO ???) times faster than the global average (TODO REF).
Projections of permafrost C emissions vary.
[@schuur_2009_effect] estimate 0.8 - 1.1 Pg C yr-1.
Back-of-the-envelope estimates from [@zimov_2006_climate_change]:
10-40 g C m-3 day-1 off the bat, slowing down to equilibrium (?) rate of 0.5-5 g C m-3 day-1 for several years.

Rapid methane release from arctic permafrost could potentially cause trillions in economic damage [@whiteman_2013_vast].

On the other hand, warming and CO2 fertilization may increase vegetation productivity, which could increase soil C storage through enhanced litterfall; the balance of these two processes is uncertain [@jones_2005_global].
There are additional uncertainties associated with vegetation composition (spatially variable peat accumulation) [@camill_2001_changes].
Other large uncertainties related to soil properties and climate model structure [@harp_2016_effect].
Several modeling studies generally predict increases in soil C sequestration at high latitudes [@burke_2017_quantifying; @qian_2010_enhanced; @ito_2016_impacts].
However, this increase is dampened or even reversed when C emissions from permafrost thaw are included [@schaefer_2011_amount; @burke_2017_quantifying].

The importance of Arctic climate feedbacks has led to efforts to incorporate these processes---particularly, permafrost thaw---into land surface models.
Early efforts derived permafrost extent and C based purely on soil temperature [@lawrence_2005_projection].
(More recent models have done this better...)
@schaefer_2011_amount -- SiBCASA estimates 190 +/- 64 Gt C, but this does not include warming feedback or discontinuous permafrost regions.
@harp_2016_effect -- Community Earth System Model (CESM) simulations over 100 years.
[@burke_2017_quantifying] -- JULES and ORCHIDEE, with new permafrost scheme, combined with intermediate complexity climate-ocean model (IMOGEN), to look at climate sensitivity to permafrost C emissions.
Models are highly sensitive to representation of soil processes, which can be more important than differences in scenario and/or climate drivers [@burke_2017_quantifying].
But @harp_2016_effect argue that model structural uncertainty is larger than soil property uncertainty.

Land surface models are expensive to run, making it challening to use them for uncertainty quantification and exploration of alternative policy scenarios.
Simple climate models are an alternative.
(More on simple climate models).

(Previous attempts to incorporate permafrost into simple climate models.)

Hector [@hartin_2015_simple].
In this study, we use Hector to evaluate the global sensitivty of climate to terrestrial biosphere processes, and how this uncertainty is affected by permafrost emissions.
The current version of Hector does not have an explicit representation of permafrost C emissions.
In this study, we investigate whether the additional complexity and parametric and structural uncertainty of an explicit representation of permafrost may be warranted in Hector.
To do this, we evaluate the sensitivity of climate variables (as predicted by Hector) to several different exogenous scenarios of permafrost C emissions.
(TODO Modify this to be about economic impact)

Some more relevant references:
- [@zimov_2006_climate_change]
- [@treat_2013_permafrost_carbon_bomb]
- [@schuur_2015_climate; @schuur_2011_climate_change; @schaefer_2014_impact; @schaefer_2011_amount; @lee_2011_rate; @kuhry_2010_potential; @kessler_2017_estimating; @hope_2015_economic; @drake_2015_ancient; @burke_2017_quantifying]

# Methods

## Model description: Hector

Hector [@hartin_2015_simple,@hartin_2016_ocean,].
Simple climate model.

(TODO: More details on terrestrial C cycle in Hector).
The default heterotrophic respiration ($R$) scheme for a pool $p$ (detritus or soil) in Hector:

$$ R_{p} = C_p \times f_p \times Q_{10} ^ \frac{T}{10} $$

## Hector permafrost sub-model

The general principle is that permafrost constitutes an additional reserve of soil carbon that, because it is frozen, is inaccessible to microbes.
As permafrost thaws and some fraction of this carbon becomes accessible to microbes, it is transferred from the frozen permafrost pool to the standard soil C pool, where it is decomposed by Hector's standard decomposition routine.
Let $C[t]_{pf}$ be the permafrost C pool and $C[t]_{s}$ be the soil C pool at time $t$ (both in units of Pg C), and let $\Delta C[t]_{pf}$ be the change in the permafrost C pool at time $t$.
The C consequences of permafrost thaw can therefore be represented as:

\[ C[t]_{pf} = C[t-1]_{pf} - \Delta C[t]_{pf} \]

\[ C[t]_{s} = C[t]_{s} + \Delta C[t]_{pf} \]

Let $C[0]_{pf}$ be the initial size of the permafrost C pool (Pg C) and $\Phi[t]$ be the fraction of permafrost remaining (in arbitrary area or volume units) at time $t$.
Assuming a uniform permafrost C density, $\Delta C[t]_{pf}$ can be expressed as:

\[ \Delta C[t]_{pf} = \Phi[t] C[0]_{pf} \]

To a first approximation, $\Phi[t]$ is a function of air temperature ($T[t]_{air}$).
[Kessler (2015)][kessler] assume this relationship is linear.
However, because the permafrost area fraction is, by definition, bounded by zero (and 1 [^1]), and because deeper permafrost thaws more slowly than shallow permafrost, we use a negative logistic relationship instead:

[^1]: Technically, permafrost area could increase in the case of cooling temperatures, and therefore the area fraction could be greater than 1. However, because even the most aggressive climate action scenarios show temperatures that stabilize above year 2000, we assume that permafrost area will never grow more than the starting value.

\[
\Phi[t] = \frac{1}{1 + \exp\left( m T[t]_{air} + b \right)}
\]

where $m$ and $b$ are model parameters.
For globally-averaged permafrost, $m = 0.829$ and $b = 4.078$ most closely reproduce the rate of 0.172 K$^{-1}$ reported by [Kessler (2015)] over the range of 2 to 6 K$^{-1}$.

```{r sigmoid, echo = FALSE}
sigmoid_cap <- paste(
  "Fraction of permafrost thaw as a function of change in",
  "global annual mean air temperature since pre-industrial (1750)."
)
m <- 0.829
b <- 4.078
kessler_m <- 0.172
kessler_b <- 2 * kessler_m + 1
plot(0, 0, type = "n", xlim = c(0, 10), ylim = c(0, 1),
     xlab = expression(Delta * T[air] ~ (K)),
     ylab = "Frac. permafrost remaining")
curve(1 / (1 + exp(m * x - b)), 0, 10, col = 1, add = TRUE)
abline(a = kessler_b, b = -kessler_m, lty = "dashed")
abline(h = 1, lty = "dotted")
legend("topright", c("Hector", "Kessler (2015)"), lty = c("solid","dashed"),
       bg = "white")
```

[kessler]: https://econpapers.repec.org/RePEc:lsg:lsgwps:wp219


## Model configurations

We evaluate the sensitivity and parametric uncertainty of three different versions of Hector.

The simplest is the "global" version, which corresponds to the standard version of Hector described in [@hartin_2015_simple].
The global land carbon sink is modeled as a single entity, with parameterizations corresponding to global averages (originally tuned to match global outputs from CMIP5; TODO REF?).
In this configuration, we vary the following parameters:
CO~2~ fertilization effect ($\beta$);
temperature sensitivity of heterotrophic respiration, ($Q^{10}_{RH}$);
fraction of net primary production C that goes to vegetation (`f_nppv`), detritus (`f_nppd`), and soil (`1 - f_nppv - f_nppd`);
and
fraction of vegetation litter C that goes to detritus (`f_litterd`).

The second is the "biome" version, which is the same as the "global" version except that the land carbon sink is divided into two "biomes": "non-permafrost" and "permafrost".
Each of these biomes has its own C pools, fluxes, and parameters.
For this configuration, we varied all of the "global" parameters (previous paragraph) for _both_ biomes ($\beta_{permafrost}$, $\beta_{non-permafrost}$, $Q^10_{RH,permafrost}$, $Q^10_{RH,non-permafrost}$, etc.), as well as the distribution of global pools (vegetation, detritus, soil) and initial primary productivity (`npp_flux0`) across these two biomes and the relative warming factor (compared to the global average) of the permafrost biome.

The third is the "biome + methane" version.
This version is the same as the "biome" version, but with an additional process that partitions total heterotrophic respiration ($R_{p,tot}$) into a CO~2~ flux ($R_{p, CO_2}$) and a CH~4~ flux ($R_p, CH_4$) as follows:

$$ R_{p,tot} = C_p \times f_p \times Q_{10} ^ \frac{T}{10} $$

$$ R_{p, CH_4} = \alpha R_{p, tot} $$

$$ R_{p, CO_2} = (1 - \alpha) ^ \phi R_{p, tot} $$

This process is controlled by two new biome-specific parameters:
$\alpha$ can be interpreted as the fraction of heterotrophic respiration C that is given off as CH~4~ assuming a perfect trade-off between CO~2~ and CH~4~ emissions.
$\phi$ defines the plasticity of this relationship;
at $\phi$ = 1, plasticity is perfect, such that $R_{p,tot}$ is evenly split between CO~2~ and CH~4~;
at $\phi$ = 0, CO~2~ emissions are entirely independent of CH~4~ emissions, such that total C emissions increase linearly with $\alpha$;
at $\phi$ > 1, CO~2~ emissions decline faster than CH~4~ emissions increase.
As such, the total C emissions attributable to heterotrophic respiration are expected to decrease as $\phi$ increases.
In this version of Hector, we varied all of the parameters in the "biome" verson, as well as $\alpha$ and $\phi$ for each biome.

## Parameter distributions

We drew parameters from loosely informative distributions that span the range of physical plausibility.
The distributions are shown in the following table (unless otherwise specified, we used the same parameter distributions for global and biome cases):

| Parameter                        | Distribution                    | Hector default value |
|----------------------------------|---------------------------------|----------------------|
| $\beta$                          | Uniform(0, 1)                   | 0.36                 |
| Q^10^~RH~                        | Uniform(0, 10)                  | 2.0                  |
| Litter-detritus fraction         | Beta(3.92, 0.08)                | 0.98                 |
| NPP vegetation fraction          | Dirichlet(**0.35**, 0.60, 0.05) | 0.35                 |
| NPP detritus fraction            | Dirichlet(0.35, **0.60**, 0.05) | 0.60                 |
|----------------------------------|---------------------------------|----------------------|
| Permafrost vegetation C fraction | Beta(1, 2)                      | --                   |
| Permafrost soil C fraction       | Beta(1.1, 1.1)                  | --                   |
| Permafrost detritus C fraction   | Beta(1.1, 1.1)                  | --                   |
| Permafrost warming factor        | 1 + 3 * Beta(5, 5)              | --                   |
|----------------------------------|---------------------------------|----------------------|
| Non-permafrost $\alpha$          | TODO                            | --                   |
| Non-permafrost $\phi$            | TODO                            |                      |
| Permafrost $\alpha$              | TODO                            |                      |
| Permafrost $\phi$                | TODO                            |                      |

These distributions are also shown in Figure 1.

```{r param-density, echo = FALSE, fig.cap = param_density_cap}
param_density_cap <- paste(
  htmlfig(),
  "Input parameter distributions for this analysis."
)
fig("param-density.png")
```

`r mdcap(param_density_cap)`

Actual permafrost surface C fraction is around 30% [@schuur_2015_climate].

We used 5000 Hector simulations for the global case and 10,000 times for the biome case (biome + methane case is TODO).


## Analysis of results

We looked at four output variables:
Atmospheric CO~2~ concentration (`Ca`),
total radiative forcing (`Ftot`),
radiative forcing from CO~2~ alone (`FCO2`),
and
global mean atmospheric temperature (`Tgav`).

First, as a metric of overall parametric uncertainty for each case, we calculated the mean, standard deviation, and 90% and 95% quantiles of the time series for each variable for each simulation.
Second, we evaluated the impact of parameters by plotting the values of each variable at 2100 as a function of input parameter value.

Third, we performed a more rigorous sensitivity and uncertainty analysis based on @lebauer_2013_facilitating.
As a metric of parameter uncertainty, we calculated the coefficient of variation (`cv`) for each input parameter as the ratio of its variance to its mean.
We evaluated sensitivity as follows:
First, we fit a multivariate Generalized Additive Model (GAM; `mgcv::gam` function in R) for each variable as a function of all the input parameters.
Then, we calculate the sensitivity ($s$) to each parameter ($x_i$) as the slope (partial derivative) of the resulting GAM at that parameter's median ($\hat{x}$; discretized at +/- 1% of the median), holding all other parameters ($x_{i+1}..x_n$) constant:

$$ s = \frac{d(GAM(x_i | x_{i + 1} .. x_n))}{d(x_i)} = \frac{GAM(1.01 x_i | ...) - GAM(0.99 x_i | ...)}{1.01 x_i - 0.99 x_i}$$

We then define the "elasticity" ($\epsilon$) (or normalized sensitivity) of the model to that parameter as:

$$ \epsilon = s \div \frac{\hat{y}} {\hat{x}} $$

Finally, we calculate the "partial variance" of each parameter (the fractional contribution of each parameter's uncertainty to overall model predictive uncertainty) by passing the distribution of each parameter through the GAM while holding all other parameters constant, calculating the resulting predictive variance for each parameter, and then normalizing these values relative to the sum of all the variances:

$$ Var(x_i) \approx Var[GAM(x_i | x_{i+1} .. x_n)] $$

$$ pvar(x_i) = \frac{Var(x_i)}{\sum_{i}^n {Var(x_i)}} $$

# Results

```{r fig-summary-ts, fig.cap = summary_ts_cap}
summary_ts_cap <- paste(
  htmlfig(),
  "Mean and 95% confidence interval on Hector simulations ",
  "with different model structures and parameter combinations."
)
fig("ts-summary.png")
```

`r mdcap(summary_ts_cap)`

## Global case

```{r fig-global-scatter, fig.cap = global_scatter_cap}
global_scatter_cap <- paste(
  htmlfig(),
  "Hector outputs at 2100 as a function of input parameter values."
)
fig("global-scatter.png")
```

`r mdcap(global_scatter_cap)`

```{r fig-global-sensitivity, fig.cap = global_sensitivity_cap, fig.dim = c(5, 5)}
global_sensitivity_cap <- paste(
  htmlfig(),
  "Sensitivity and variance decomposition analysis for global Hector."
)
fig("sensitivity-global.png")
```

`r mdcap(global_sensitivity_cap)`

## Biome case

```{r fig-biome-scatter, fig.cap = biome_scatter_cap}
biome_scatter_cap <- paste(
  htmlfig(),
  "Hector outputs (with permafrost biome) at 2100 as a function of input parameter values."
)
fig("biome-scatter.png")
```

`r mdcap(biome_scatter_cap)`

```{r fig-biome-sensitivity, fig.cap = biome_sensitivity_cap}
biome_sensitivity_cap <- paste(
  htmlfig(),
  "Sensitivity and variance decomposition analysis for Hector with permafrost biome."
)
fig("sensitivity-biome.png")
```

`r mdcap(biome_sensitivity_cap)`

## Permafrost methane emissions

**Figure**: Hector projections of parameter sensitivity (CI ribbon, or light/transparent lines), colored (faceted?) by case.

**Figure**: PEcAn-like variance decomposition of parameters (for each parameter: sensitivity, uncertainty, and partial variance)

# Discussion

Rate of permafrost C release also depends on soil moisture conditions -- drier soils release C much faster ("carbon bomb") than wetter soils ("carbon fizz") [@elberling_2013_long].
Moisture will also affect the balance of aerobic (CO2 release) vs. anaerobic (CH4) C release [@turetsky_2002_boreal], to the extent that unclear if anaerobic (wet) areas are C sources or sinks [@wickland_2006_effects].
Effects of permafrost thaw on soil moisture are a complex hydrological problem -- drainage very sensitive to local (micro-)topography [@wickland_2006_effects].
So will vegetation cover [@wickland_2006_effects].

Temperature amplification of permafrost carbon feedback (by 2100) 0.02 to 0.36 째C [@burke_2013_estimating; @schneider_2012_estimating; @schneider_2015_observation], or 0.1 to 0.8 째C in [@macdougall_2012_significant; @macdougall_2013_if], or 10-40% of peak temperature change [@crichton_2016_permafrost], or 0.2 to 12% [@burke_2017_quantifying].

Permafrost carbon has greater impact at lower emissions scenarios [@burke_2017_quantifying; @macdougall_2012_significant; @macdougall_2013_if] .

# Conclusion

# Acknowledgments

Funded by EPA grant XXX.
Cyberinfrastructure support from Pacific Northwest National Laboratory (PNNL).

# Miscellaneous notes

## Permafrost emissions scenarios

Digitized scenarios from [@schaefer_2011_amount].
SiBCASA model predictions of CO2 emissions (permafrost respiration; $R_{pc}$; note -- no methane!) through 2300.
These results were digitized using WebPlotDigitizer (https://apps.automeris.io/wpd/), and interpolated to annual resolution (using R `stats::spline` function).

Digitized scenarios from [@hope_2015_economic].
CO2 and CH4 emissions from SiBCASA model.

[@schuur_2009_effect] -- Estimate 0.8 - 1.1 Pg C yr-1.

Back-of-the-envelope estimates from [@zimov_2006_climate_change]:
- 500 Gt C in loess that could be completely emitted by 2100 (plus other C sources).
- 10-40 g C m-3 day-1 off the bat, slowing down to equilibrium (?) rate of 0.5-5 g C m-3 day-1 for several years. Combine with data on permafrost spatial extent, density, etc. to generate estimates (but can back-calculate from 500 Gt C above?)


## Parameter calibration

We used the `BayesianTools` R package [@R-BayesianTools] for all parameter calibration.
The outputs of these calibrations are joint posterior distributions of parameters and their covariances, from which we sample for the sensitivity analysis.

For global parameters, we used the following likelihood:

$$ \log(L) = \sum_s Normal(Hector(\beta, Q_{10}, s) | CMIP5(s), \sigma) $$

where $s$ is one of the four representative carbon pathways (RCPs), $CMIP5(s)$ are the CMIP5 global mean outputs for the corresponding variables, and $\sigma$ is the model error (estimated during the fit).
We also used the resulting distributions for $\beta$ and $Q_{10}$ for the non-permafrost biome in cases 2 and 3.
We feel this is appropriate because the CMIP5 models against which these parameters are calibrated do not include permafrost C feedbacks.

For case 2, we calibrated the permafrost-specific $\beta$ and $Q_{10}$ against various literature sources, including:

- Land surface model simulations [@hope_2015_economic; @schaefer_2011_amount; @burke_2017_quantifying].
    - Try to calibrate against NPP and soil respiration if possible
- Literature surveys [@schaefer_2014_impact] 
- Warming experiments [@wickland_2006_effects]
- TODO: Others?

Some of these are time series, while others are individual estimates at particular points in time.
To give them equal weight in the likelihood, we down-weight the time series likelihoods by the number of time steps.

We derived a distribution for the Arctic warming factor from TODO.

TODO: Table and multi-panel figure of input datasets.

For the $\alpha$ and $\phi$ parameters in case 3, we looked at the literature on permafrost methane emissions [e.g., @wickland_2006_effects].

## Other notes

Frozen carbon residence time (FCRt) from [@burke_2017_quantifying]:

$$ FCRt = FCRt0 * exp(-\Delta T / \Gamma) (for \Delta T > 0.2 째C) $$

- $FCRt_0$ (years) reflects the stability of permafrost C (length of time that permafrost C is stable when $\Delta T = 0$)
- $\Gamma$ -- decay term (째C); temperature change at which "the number of years taken for all of the old permafrost C to be emitted reduces to 1/e of its initial value"

Other Hector parameters to consider.

| Variable | INI name | Description                                 | Value |
|----------|----------|---------------------------------------------|-------|
| $f_{nv}$ | `f_nppv` | Fraction of NPP C transferred to vegetation | 0.35  |
| $f_{nd}$ | `f_nppd` | Fraction of NPP C transferred to detritus   | 0.60  |
| $f_{nd}$ |          | Fraction of NPP C transferred to soil       | 0.05  |
| $f_{lv}$ | `f_lucv` | Fraction of LUC change flux from vegetation | 0.10  |
| $f_{ld}$ | `f_lucd` | Fraction of LUC change flux from detritus   | 0.01  |
| $f_{ls}$ |          | Fraction of LUC change flux from soil       | 0.89  |
| $f_{ds}$ |          | Fraction of detritus C that goes to soil    | 0.60  |
| $f_{rd}$ |          | Fraction of respiration C to detritus       | 0.25  |
| $f_{rs}$ |          | Fraction of respriation C to soil           | 0.02  |

According to [@hartin_2015_simple], these were selected to be "generally consistent with previous simple earth system models [e.g., @meinshausen_2011_emulating]".

<!-- The following line inserts a page break when the output is MS Word. For page breaks in PDF, use \newpage on its own line.  -->
##### pagebreak

# References 
<!-- The following line ensures the references appear here for the MS Word or HTML output files, rather than right at the end of the document (this will not work for PDF files):  -->
<div id="refs"></div>

##### pagebreak

# Appendix

```{r fig-global-dist, fig.cap = global_dist_cap}
global_dist_cap <- paste(
  htmlfig(),
  "Input parameter distributions for global Hector."
)
fig("global_draws.png")
```

`r mdcap(global_dist_cap)`

```{r fig-biome-dist, fig.cap = biome_dist_cap, fig.dim = c(9, 9)}
biome_dist_cap <- paste(
  htmlfig(),
  "Input parameter distributions for Hector with biomes."
)
fig("biome_draws.png")
```

`r mdcap(biome_dist_cap)`

```{r fig-global-timeseries, fig.cap = global_ts_cap, fig.dim = c(10, 8)}
global_ts_cap <- paste(
  htmlfig(),
  "Time series of Hector outputs for different parameter combinations."
)
readd(ts_global_sims)
```

`r mdcap(global_ts_cap)`

```{r fig-biome-timeseries, fig.cap = biome_ts_cap, fig.dim = c(10, 8)}
biome_ts_cap <- paste(
  htmlfig(),
  "Overall parameter uncertainty of Hector simulations with permafrost biome."
)
readd(ts_biome_sims)
```

`r mdcap(biome_ts_cap)`


### Colophon

This report was generated on `r Sys.time()` using the following computational environment and dependencies: 

```{r colophon, cache = FALSE}
# which R packages and versions?
devtools::session_info()
```

The current Git commit details are:

```{r}
# what commit is this file at? You may need to change the path value
# if your Rmd is not in analysis/paper/
git2r::repository("../..")
```
