---
title: "Hector Permafrost"
author:
  - Alexey N. Shiklomanov
  - Ben Bond-Lamberty
  - Ben Kravitz?
  - Kate Calvin?
  - Corinne Hartin
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: 
    bookdown::html_document2:
      fig_caption: yes
      reference_docx: "../templates/template.docx"
    rmarkdown::github_document:
      html_preview: false
bibliography: ["references.bib", "packages.bib"]
csl: "../templates/biogeosciences.csl"
abstract: |
  Text of abstract
keywords: |
  keyword 1; keyword 2; keyword 3
highlights: |
  These are the highlights. 
---

```{r, setup, echo = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  warning = FALSE,
  message = FALSE,
  echo = FALSE,
  comment = "#>"
)

library(hector.permafrost.emit) # Or use devtools::load_all('.', quiet = T) if your code is in script files, rather than as functions in the `/R` diretory
```

# Introduction

Climate change is a problem (CITE: IPCC, NCA, etc.).
Important to reduce carbon emissions to meet temperature targets.
The extent of anthropogenic emissions reduction depends on what how much help (or push-back) we get from the physical and biological Earth systems.

Permafrost is an important C reservoir.
Total northern soil C pool is estimated at 1672 PgC, of which approximately 1466 Pg (88%) is in permafrost [@tarnocai_2009_soil].
This frozen C can be released into the atmosphere by several processes related to warming, including aerobic respiration in thawed soil (REF) and anaeribic respiration in thermokarst lakes and wetlands [@turetsky_2002_boreal; @wickland_2006_effects].
But emissions from wet soils may be offset by high organic matter accumulation rates [@camill_2001_changes].
Permafrost thaw in boreal peatlands in north-central Saskatchewan increased CO2 and CH4 fluxes from soil to atmosphere by 1.6 and 30 times, respectively [@turetsky_2002_boreal].
These impacts are exacerbated by the fact that the Arctic is warming roughly 2.5 (TODO ???) times faster than the global average (TODO REF).
Projections of permafrost C emissions vary.
[@schuur_2009_effect] estimate 0.8 - 1.1 Pg C yr-1.
Back-of-the-envelope estimates from [@zimov_2006_climate_change]: 10-40 g C m-3 day-1 off the bat, slowing down to equilibrium (?) rate of 0.5-5 g C m-3 day-1 for several years.

On the other hand, warming and CO2 fertilization may increase vegetation productivity, which could increase soil C storage through enhanced litterfall; the balance of these two processes is uncertain [@jones_2005_global].
Several modeling studies generally predict increases in soil C in high latitudes [@burke_2017_quantifying; @qian_2010_enhanced; @ito_2016_impacts].
However, this increase is dampened by including permafrost C [@burke_2017_quantifying].

(Previous work on modeling permafrost)
[@burke_2017_quantifying] -- JULES and ORCHIDEE, with new permafrost scheme, combined with intermediate complexity climate-ocean model (IMOGEN), to look at climate sensitivity to permafrost C emissions.
Models are highly sensitive to representation of soil processes, which can be more important than differences in scenario and/or climate drivers [@burke_2017_quantifying].

Several studies have attempted to evaluate the potential economic impacts of current and future permafrost C emissions.
@lawrence_2012_simulation project declines in near-surface permafrost by 33% and 72% in RCP 2.6 and 8.5, respectively, and permafrost C feedback will stabilize at 2100 in RCP 2.6.
More recently, @hope_2015_economic projected permafrost C emissions using the SiBCASA (TODO: write in full) land surface model and used these projections as inputs to the PAGE09 integrated assessment model (IAM).
They found that XXX.
@chen_2019_economic also used PAGE09.
Similarly, @gonzalez-eguino_2016_significant used the DICE (TODO: write in full) model to XXX.
@kessler_2017_estimating also used DICE.

@hope_2015_economic (and others?) rely on climate damage functions of the general form $\delta GDP = f(\delta T)$.
Such functions are, at best, highly uncertain (TODO REF), and possibly conceptually flawed (TODO REF).
(TODO More on this).
GCAM (TODO full name) is an alternative (TODO REF).
(TODO More on GCAM).

(Paragraph on simple climate models.)
Hector [@hartin_2015_simple].
However, Hector does not have an explicit representation of permafrost C emissions.
In this study, we investigate whether the additional complexity and parametric and structural uncertainty of an explicit representation of permafrost may be warranted in Hector.
To do this, we evaluate the sensitivity of climate variables (as predicted by Hector) to several different exogenous scenarios of permafrost C emissions.
(TODO Modify this to be about economic impact)

Some more relevant references:
- [@zimov_2006_climate_change]
- [@treat_2013_permafrost_carbon_bomb]
- [@schuur_2015_climate; @schuur_2011_climate_change; @schaefer_2014_impact; @schaefer_2011_amount; @lee_2011_rate; @kuhry_2010_potential; @kessler_2017_estimating; @hope_2015_economic; @drake_2015_ancient; @burke_2017_quantifying]

# Methods

## Model description: Hector

Hector [@hartin_2015_simple,@hartin_2016_ocean].
Simple climate model.

## Permafrost emissions scenarios

For all scenarios, we added the emission as a combination of fossil fuel CO2 emissions (`ffi_emissions` column in Hector) and methane emissions (`CH4_emissions` column in Hector).
Where these were explicitly separated, we added them accordingly.
Where they were presented only in terms of C, we did ??? 

Digitized scenarios from [@schaefer_2011_amount].
SiBCASA model predictions of CO2 emissions (permafrost respiration; $R_{pc}$; note -- no methane!) through 2300.
These results were digitized using WebPlotDigitizer (https://apps.automeris.io/wpd/), and interpolated to annual resolution (using R `stats::spline` function).

Digitized scenarios from [@hope_2015_economic].
CO2 and CH4 emissions from SiBCASA model.

[@schuur_2009_effect] -- Estimate 0.8 - 1.1 Pg C yr-1.

Back-of-the-envelope estimates from [@zimov_2006_climate_change]:
- 500 Gt C in loess that could be completely emitted by 2100 (plus other C sources).
- 10-40 g C m-3 day-1 off the bat, slowing down to equilibrium (?) rate of 0.5-5 g C m-3 day-1 for several years. Combine with data on permafrost spatial extent, density, etc. to generate estimates (but can back-calculate from 500 Gt C above?)


## Modeling permafrost emissions

Default heterotrophic respiration ($R$) scheme for a pool $p$ (detritus or soil) in Hector:

$$ R_{p} = C_p \times f_p \times Q_{10} ^ \frac{T}{10} $$

This is case 1.

Case 2 uses the same formulation, but splits permafrost C into its own "biome", with its own photosynthesis ($\beta$) and respiration ($Q_{10}$) parameters.

Case 3 extends Case 2 by calculating CO~2~ and CH~4~ emissions as a fraction of the total respiration, controlled by two new parameters $\alpha$ and $\phi$:

$$ R_{p,tot} = C_p \times f_p \times Q_{10} ^ \frac{T}{10} $$

$$ R_{p, CH_4} = \alpha R_{p, tot} $$

$$ R_{p, CO_2} = (1 - \alpha) ^ \phi R_{p, tot} $$


## Parameter calibration

We used the `BayesianTools` R package [@R-BayesianTools] for all parameter calibration.
The outputs of these calibrations are joint posterior distributions of parameters and their covariances, from which we sample for the sensitivity analysis.

For global parameters, we used the following likelihood:

$$ \log(L) = \sum_s Normal(Hector(\beta, Q_{10}, s) | CMIP5(s), \sigma) $$

where $s$ is one of the four representative carbon pathways (RCPs), $CMIP5(s)$ are the CMIP5 global mean outputs for the corresponding variables, and $\sigma$ is the model error (estimated during the fit).
We also used the resulting distributions for $\beta$ and $Q_{10}$ for the non-permafrost biome in cases 2 and 3.
We feel this is appropriate because the CMIP5 models against which these parameters are calibrated do not include permafrost C feedbacks.

For case 2, we calibrated the permafrost-specific $\beta$ and $Q_{10}$ against various literature sources, including:

- Land surface model simulations [@hope_2015_economic; @schaefer_2011_amount; @burke_2017_quantifying].
    - Try to calibrate against NPP and soil respiration if possible
- Literature surveys [@schaefer_2014_impact] 
- Warming experiments [@wickland_2006_effects]
- TODO: Others?

Some of these are time series, while others are individual estimates at particular points in time.
To give them equal weight in the likelihood, we down-weight the time series likelihoods by the number of time steps.

We derived a distribution for the Arctic warming factor from TODO.

TODO: Table and multi-panel figure of input datasets.

For the $\alpha$ and $\phi$ parameters in case 3, we looked at the literature on permafrost methane emissions [e.g., @wickland_2006_effects].


## Initial conditions

For case 1, we use the Hector defaults [@hartin_2015_simple].

For cases 2 and 3, we assumed the same total pool sizes as case 1, but divided them into the permafrost and non-permafrost biomes according to TODO.


## Other notes

Frozen carbon residence time (FCRt) from [@burke_2017_quantifying]:

$$ FCRt = FCRt0 * exp(-\Delta T / \Gamma) (for \Delta T > 0.2 째C) $$

- $FCRt_0$ (years) reflects the stability of permafrost C (length of time that permafrost C is stable when $\Delta T = 0$)
- $\Gamma$ -- decay term (째C); temperature change at which "the number of years taken for all of the old permafrost C to be emitted reduces to 1/e of its initial value"

Other Hector parameters to consider.

| Variable | INI name | Description                                 | Value |
|----------|----------|---------------------------------------------|-------|
| $f_{nv}$ | `f_nppv` | Fraction of NPP C transferred to vegetation | 0.35  |
| $f_{nd}$ | `f_nppd` | Fraction of NPP C transferred to detritus   | 0.60  |
| $f_{nd}$ |          | Fraction of NPP C transferred to soil       | 0.05  |
| $f_{lv}$ | `f_lucv` | Fraction of LUC change flux from vegetation | 0.10  |
| $f_{ld}$ | `f_lucd` | Fraction of LUC change flux from detritus   | 0.01  |
| $f_{ls}$ |          | Fraction of LUC change flux from soil       | 0.89  |
| $f_{ds}$ |          | Fraction of detritus C that goes to soil    | 0.60  |
| $f_{rd}$ |          | Fraction of respiration C to detritus       | 0.25  |
| $f_{rs}$ |          | Fraction of respriation C to soil           | 0.02  |

According to [@hartin_2015_simple], these were selected to be "generally consistent with previous simple earth system models [e.g., @meinshausen_2011_emulating]".

```{r fig-parameter-distribution, fig.cap = param_dist_cap}
param_dist_cap <- paste(
  "Input parameter distributions for global Hector."
)
readd(draws_plot)
```


# Results

## Global Hector

```{r fig-global-timeseries, fig.cap = global_ts_cap, fig.dim = c(10, 8)}
global_ts_cap <- paste(
  "Time series of Hector outputs for different parameter combinations."
)
readd(ts_global_sims)
```

```{r fig-global-scatter, fig.cap = global_scatter_cap, fig.dim = c(8, 5)}
global_scatter_cap <- paste(
  "Hector outputs at 2100 as a function of input parameter values."
)
readd(scatter_lastyear_global_sims)
```

```{r fig-global-sensitivity, fig.cap = global_sensitivity_cap, fig.dim = c(5, 5)}
global_sensitivity_cap <- paste(
  "Sensitivity and variance decomposition analysis for global Hector."
)
readd(sensitivity_plot_sensitivity_global_params_lastyear_global_sims)
```

## Permafrost as a biome

```{r fig-biome-timeseries, fig.cap = biome_ts_cap, fig.dim = c(10, 8)}
biome_ts_cap <- paste(
  "Overall parameter uncertainty of Hector simulations with permafrost biome."
)
readd(ts_biome_sims)
```

```{r fig-biome-scatter, fig.cap = biome_scatter_cap, fig.dim = c(8, 8)}
biome_scatter_cap <- paste(
  "Hector outputs (with permafrost biome) at 2100 as a function of input parameter values."
)
readd(scatter_lastyear_biome_sims)
```

```{r fig-biome-sensitivity, fig.cap = biome_sensitivity_cap, fig.dim = c(5, 7)}
biome_sensitivity_cap <- paste(
  "Sensitivity and variance decomposition analysis for Hector with permafrost biome."
)
readd(sensitivity_plot_sensitivity_biome_params_lastyear_biome_sims)
```

## Permafrost methane emissions

**Figure**: Hector projections of parameter sensitivity (CI ribbon, or light/transparent lines), colored (faceted?) by case.

**Figure**: PEcAn-like variance decomposition of parameters (for each parameter: sensitivity, uncertainty, and partial variance)

# Discussion

Rate of permafrost C release also depends on soil moisture conditions -- drier soils release C much faster ("carbon bomb") than wetter soils ("carbon fizz") [@elberling_2013_long].
Moisture will also affect the balance of aerobic (CO2 release) vs. anaerobic (CH4) C release [@turetsky_2002_boreal], to the extent that unclear if anaerobic (wet) areas are C sources or sinks [@wickland_2006_effects].
Effects of permafrost thaw on soil moisture are a complex hydrological problem -- drainage very sensitive to local (micro-)topography [@wickland_2006_effects].
So will vegetation cover [@wickland_2006_effects].

Temperature amplification of permafrost carbon feedback (by 2100) 0.02 to 0.36 째C [@burke_2013_estimating; @schneider_2012_estimating; @schneider_2015_observation], or 0.1 to 0.8 째C in [@macdougall_2012_significant; @macdougall_2013_if], or 10-40% of peak temperature change [@crichton_2016_permafrost], or 0.2 to 12% [@burke_2017_quantifying].

Permafrost carbon has greater impact at lower emissions scenarios [@burke_2017_quantifying; @macdougall_2012_significant; @macdougall_2013_if] .

# Conclusion

# Acknowledgments

Funded by EPA grant XXX.
Cyberinfrastructure support from Pacific Northwest National Laboratory (PNNL).

<!-- The following line inserts a page break when the output is MS Word. For page breaks in PDF, use \newpage on its own line.  -->
##### pagebreak

# References 
<!-- The following line ensures the references appear here for the MS Word or HTML output files, rather than right at the end of the document (this will not work for PDF files):  -->
<div id="refs"></div>

##### pagebreak

### Colophon

This report was generated on `r Sys.time()` using the following computational environment and dependencies: 

```{r colophon, cache = FALSE}
# which R packages and versions?
devtools::session_info()
```

The current Git commit details are:

```{r}
# what commit is this file at? You may need to change the path value
# if your Rmd is not in analysis/paper/
git2r::repository("../..")
```
